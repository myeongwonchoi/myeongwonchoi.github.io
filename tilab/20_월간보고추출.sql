/***********************************************************************
	- 제     목: 20_월간보고_추출
	- 최초작성일: 2025-05-22
	- 최초작성자: 최명원
	- 최종수정일: 2025-11-19	
	- 최종작성자: 최명원
	- 특이사항
	 -- 날짜 입력 예시)
	    * 4월: 250401 ~ 250420 이므로 '2025-04-01 00:00:00.000' , '2025-04-21 00:00:00.000'
		* 5월: 250421 ~ 250518 이므로 '2025-04-21 00:00:00.000' , '2025-05-19 00:00:00.000'
		* 6월: 250519 ~ 250615 이므로 '2025-05-19 00:00:00.000' , '2025-06-16 00:00:00.000'
		* 7월: 250616 ~ 250720 이므로 '2025-06-16 00:00:00.000' , '2025-07-21 00:00:00.000'
		* 8월: 250719 ~ 250814 이므로 '2025-07-19 00:00:00.000' , '2025-08-15 00:00:00.000'
		* 9월: 250818 ~ 250914 이므로 '2025-08-18 00:00:00.000' ,' 2025-09-15 00:00:00.000'
		* 10월: 250915 ~ 251017 이므로 '2025-09-15 00:00:00.000' ,' 2025-10-18 00:00:00.000'
		* 11월: 251018 ~ 251116 이므로 '2025-10-18 00:00:00.000' , '2025-11-17 00:00:00.000'
		* 12월: 251117 ~ 251214 이므로 '2025-11-17 00:00:00.000' , '2025-12-15 00:00:00.000'
************************************************************************/

USE POI_MAIN_PRACT

/*
 CORE POI 현황
*/
SELECT COUNT(*) AS '티아이랩_전체_CORE_POI'
FROM vPOI_I_COMMON_ALL_GRS A, PTC_POI_CLASS B, PTC_CLASS C, POI_MAIN_ETC..[22y_2150_INDEX_220401] D
WHERE A.POI_ID = B.POI_ID
AND B.CLASS_CODE = C.CLASS_CODE
AND LEFT(A.TILE_ID,4) = D.MAP_ID
AND D.관할업체 = '티아이랩'
AND A.INSERT_DATE < '2025-12-15 00:00:00.000' 
AND A.UPDATE_DATE < '2025-12-15 00:00:00.000' 

/*
 25년 12월에 UC 체크 작업한 아파트 POI 현황
*/
SELECT COUNT(*) AS '25년_12월에_UC_작업_아파트_POI'
FROM vPOI_I_COMMON_ALL_GRS A, PTC_POI_CLASS B, PTC_CLASS C, POI_MAIN_ETC..[22y_2150_INDEX_220401] D
WHERE A.POI_ID = B.POI_ID
AND B.CLASS_CODE = C.CLASS_CODE
AND LEFT(A.TILE_ID,4) = D.MAP_ID
AND D.관할업체 = '티아이랩'
AND A.INSERT_DATE BETWEEN '2025-11-17 00:00:00.000' AND '2025-12-15 00:00:00.000'
-- AND A.UPDATE_DATE < '2025-06-16 00:00:00.000'
AND A.CLASS_A = 8
AND A.CLASS_B = 1
AND A.CLASS_C = 7
AND A.CLASS_D = 99
AND A.ERR_CODE IN (770, 514, 832, 864, 576,608, 768, 800, 512, 544)

/*
 25년 12월까지의 UC 아파트 POI 현황
*/
SELECT COUNT(*) AS '25년_12월_기준_UC체크_아파트_POI'
FROM vPOI_I_COMMON_ALL_GRS A, PTC_POI_CLASS B, PTC_CLASS C, POI_MAIN_ETC..[22y_2150_INDEX_220401] D
WHERE A.POI_ID = B.POI_ID
AND B.CLASS_CODE = C.CLASS_CODE
AND LEFT(A.TILE_ID,4) = D.MAP_ID
AND D.관할업체 = '티아이랩'
AND A.INSERT_DATE < '2025-11-17 00:00:00.000' 
AND A.UPDATE_DATE < '2025-12-15 00:00:00.000'
AND A.CLASS_A = 8
AND A.CLASS_B = 1
AND A.CLASS_C = 7
AND A.CLASS_D = 99
AND A.ERR_CODE IN (770, 514, 832, 864, 576,608, 768, 800, 512, 544)

/*
 25년 12월까지의 UC 아파트 POI 
*/
SELECT DISTINCT A.POI_ID, A.FNAME, A.CNAME, B.CLASS_CODE, A.CENTER_X1, A.CENTER_Y1, A.ADDR, A.ADDR2, A.SAN_BUN, A.PRIMARY_BUN, A.SECONDARY_BUN
FROM vPOI_I_COMMON_ALL_GRS A, PTC_POI_CLASS B, PTC_CLASS C, POI_MAIN_ETC..[22y_2150_INDEX_220401] D
WHERE A.POI_ID = B.POI_ID
AND B.CLASS_CODE = C.CLASS_CODE
AND LEFT(A.TILE_ID,4) = D.MAP_ID
AND D.관할업체 = '티아이랩'
AND A.INSERT_DATE > '2025-11-17 00:00:00.000' 
AND A.UPDATE_DATE < '2025-12-15 00:00:00.000'
AND A.CLASS_A = 8
AND A.CLASS_B = 1
AND A.CLASS_C = 7
AND A.CLASS_D = 99
AND A.ERR_CODE IN (770, 514, 832, 864, 576,608, 768, 800, 512, 544)

/*
 25년 12월에 UC 체크해제 작업한 아파트 POI 현황
*/
SELECT DISTINCT A.POI_ID, A.FNAME, A.CNAME, B.CLASS_CODE, A.CENTER_X1, A.CENTER_Y1, A.ADDR, A.ADDR2, A.SAN_BUN, A.PRIMARY_BUN, A.SECONDARY_BUN -- COMMENT로 인해 중복이 존재하므로 해당 쿼리로 수량 파악필수.
-- COUNT(*) AS '25년_9월에_UC_해제한_아파트_POI'
FROM vPOI_I_COMMON_ALL_GRS A, PTC_POI_CLASS B, PTC_CLASS C, POI_MAIN_ETC..[22y_2150_INDEX_220401] D, PTN_WORK_COMMENT E
WHERE A.POI_ID = B.POI_ID
AND B.CLASS_CODE = C.CLASS_CODE
AND LEFT(A.TILE_ID,4) = D.MAP_ID
AND D.관할업체 = '티아이랩'
AND A.POI_ID = E.POI_ID
AND A.CLASS_A = 8
AND A.CLASS_B = 1
AND A.CLASS_C = 7
AND A.CLASS_D = 99
AND A.ERR_CODE NOT IN (770, 514, 832, 864, 576,608, 768, 800, 512, 544)
AND E.COMMENT LIKE '%UC%해제%'
AND E.INSERT_DATE BETWEEN '2025-11-17 00:00:00.000' AND '2025-12-15 00:00:00.000'


/*
 25년 12월까지의 아파트 POI 현황
*/
SELECT COUNT(*) AS '25년_10월_기준_전체_아파트_POI'
FROM vPOI_I_COMMON_ALL_GRS A, PTC_POI_CLASS B, PTC_CLASS C, POI_MAIN_ETC..[22y_2150_INDEX_220401] D
WHERE A.POI_ID = B.POI_ID
AND B.CLASS_CODE = C.CLASS_CODE
AND LEFT(A.TILE_ID,4) = D.MAP_ID
AND D.관할업체 = '티아이랩'
AND A.INSERT_DATE < '2025-11-17 00:00:00.000' 
AND A.UPDATE_DATE < '2025-12-15 00:00:00.000'
AND A.CLASS_A = 8
AND A.CLASS_B = 1
AND A.CLASS_C = 7
AND A.CLASS_D = 99
AND A.ERR_CODE NOT IN (770, 514, 832, 864, 576,608, 768, 800, 512, 544)

/*
 25년 12월에 작업한 DT POI 현황
*/
SELECT DISTINCT A.POI_ID, A.FNAME, A.CNAME -- POI_ID 중복이 존재하므로 해당 쿼리로 수량 파악필수.
-- COUNT(*) AS '25년_8월에_작업한_DT_POI'
FROM vPOI_I_COMMON_ALL_GRS A, PTC_POI_CLASS B, PTC_CLASS C, POI_MAIN_ETC..[22y_2150_INDEX_220401] D, PTN_ADD_BASIC E
WHERE A.POI_ID = B.POI_ID
AND B.CLASS_CODE = C.CLASS_CODE
AND LEFT(A.TILE_ID,4) = D.MAP_ID
AND D.관할업체 = '티아이랩'
AND A.POI_ID = E.POI_ID
AND E.ADD_CODE = 1
AND A.INSERT_DATE BETWEEN '2025-11-17 00:00:00.000' AND '2025-12-15 00:00:00.000'

/*
 25년 12월까지의 DT POI 현황
*/
SELECT DISTINCT COUNT(*) AS '25년_10월_기준_전체_DT_POI'
FROM vPOI_I_COMMON_ALL_GRS A, PTC_POI_CLASS B, PTC_CLASS C, POI_MAIN_ETC..[22y_2150_INDEX_220401] D, PTN_ADD_BASIC E
WHERE A.POI_ID = B.POI_ID
AND B.CLASS_CODE = C.CLASS_CODE
AND LEFT(A.TILE_ID,4) = D.MAP_ID
AND D.관할업체 = '티아이랩'
AND A.POI_ID = E.POI_ID
AND E.ADD_CODE = 1
AND A.INSERT_DATE < '2025-11-17 00:00:00.000' 
AND A.UPDATE_DATE < '2025-12-15 00:00:00.000'

/*
 25년 4월까지의 POI 현황
*/
--SELECT C.CA_NAME, COUNT(*) AS '25년_4월_수량'
--FROM vPOI_I_COMMON_ALL_GRS A, PTC_POI_CLASS B, PTC_CLASS C, POI_MAIN_ETC..[22y_2150_INDEX_220401] D
--WHERE A.POI_ID = B.POI_ID
--AND B.CLASS_CODE = C.CLASS_CODE
--AND LEFT(A.TILE_ID,4) = D.MAP_ID
--AND D.관할업체 = '티아이랩'
--AND A.INSERT_DATE < '2025-04-21 00:00:00.000' 
--AND A.UPDATE_DATE < '2025-04-21 00:00:00.000'
--GROUP BY C.CA_NAME
--ORDER BY CA_NAME

/*
 25년 5월까지의 POI 현황
*/
--SELECT C.CA_NAME, COUNT(*) AS '25년_5월_수량'
--FROM vPOI_I_COMMON_ALL_GRS A, PTC_POI_CLASS B, PTC_CLASS C, POI_MAIN_ETC..[22y_2150_INDEX_220401] D
--WHERE A.POI_ID = B.POI_ID
--AND B.CLASS_CODE = C.CLASS_CODE
--AND LEFT(A.TILE_ID,4) = D.MAP_ID
--AND D.관할업체 = '티아이랩'
--AND A.INSERT_DATE < '2025-05-19 00:00:00.000' 
--AND A.UPDATE_DATE < '2025-05-19 00:00:00.000'
--GROUP BY C.CA_NAME
--ORDER BY CA_NAME

/*
 25년 6월까지의 POI 현황
*/
--SELECT C.CA_NAME, COUNT(*) AS '25년_6월_수량'
--FROM vPOI_I_COMMON_ALL_GRS A, PTC_POI_CLASS B, PTC_CLASS C, POI_MAIN_ETC..[22y_2150_INDEX_220401] D
--WHERE A.POI_ID = B.POI_ID
--AND B.CLASS_CODE = C.CLASS_CODE
--AND LEFT(A.TILE_ID,4) = D.MAP_ID
--AND D.관할업체 = '티아이랩'
--AND A.INSERT_DATE < '2025-06-16 00:00:00.000' 
--AND A.UPDATE_DATE < '2025-06-16 00:00:00.000'
--GROUP BY C.CA_NAME
--ORDER BY CA_NAME

/*
 25년 7월까지의 POI 현황
*/
--SELECT C.CA_NAME, COUNT(*) AS '25년_7월_수량'
--FROM vPOI_I_COMMON_ALL_GRS A, PTC_POI_CLASS B, PTC_CLASS C, POI_MAIN_ETC..[22y_2150_INDEX_220401] D
--WHERE A.POI_ID = B.POI_ID
--AND B.CLASS_CODE = C.CLASS_CODE
--AND LEFT(A.TILE_ID,4) = D.MAP_ID
--AND D.관할업체 = '티아이랩'
--AND A.INSERT_DATE < '2025-07-21 00:00:00.000' 
--AND A.UPDATE_DATE < '2025-07-21 00:00:00.000'
--GROUP BY C.CA_NAME
--ORDER BY CA_NAME

/*
  25년 8월까지의 POI 현황
*/
--SELECT C.CA_NAME, COUNT(*) AS '티아이랩_전체_CORE_POI'
--FROM vPOI_I_COMMON_ALL_GRS A, PTC_POI_CLASS B, PTC_CLASS C, POI_MAIN_ETC..[22y_2150_INDEX_220401] D
--WHERE A.POI_ID = B.POI_ID
--AND B.CLASS_CODE = C.CLASS_CODE
--AND LEFT(A.TILE_ID,4) = D.MAP_ID
--AND D.관할업체 = '티아이랩'
--AND A.INSERT_DATE < '2025-08-15 00:00:00.000' 
--AND A.UPDATE_DATE < '2025-08-15 00:00:00.000'
--GROUP BY C.CA_NAME
--ORDER BY CA_NAME

/*
  25년 9월까지의 POI 현황
*/
--SELECT C.CA_NAME, COUNT(*) AS '티아이랩_전체_CORE_POI'
--FROM vPOI_I_COMMON_ALL_GRS A, PTC_POI_CLASS B, PTC_CLASS C, POI_MAIN_ETC..[22y_2150_INDEX_220401] D
--WHERE A.POI_ID = B.POI_ID
--AND B.CLASS_CODE = C.CLASS_CODE
--AND LEFT(A.TILE_ID,4) = D.MAP_ID
--AND D.관할업체 = '티아이랩'
--AND A.INSERT_DATE < '2025-09-15 00:00:00.000' 
--AND A.UPDATE_DATE < '2025-09-15 00:00:00.000'
--GROUP BY C.CA_NAME
--ORDER BY CA_NAME

/*
  25년 10월까지의 POI 현황
*/
--SELECT COUNT(*) AS '티아이랩_전체_CORE_POI'
--FROM vPOI_I_COMMON_ALL_GRS A, PTC_POI_CLASS B, PTC_CLASS C, POI_MAIN_ETC..[22y_2150_INDEX_220401] D
--WHERE A.POI_ID = B.POI_ID
--AND B.CLASS_CODE = C.CLASS_CODE
--AND LEFT(A.TILE_ID,4) = D.MAP_ID
--AND D.관할업체 = '티아이랩'
--AND A.INSERT_DATE < '2025-10-18 00:00:00.000' 
--AND A.UPDATE_DATE < '2025-10-18 00:00:00.000'
--GROUP BY C.CA_NAME
--ORDER BY CA_NAME


/*
  25년 11월까지의 POI 현황
*/
--SELECT COUNT(*) AS '티아이랩_전체_CORE_POI'
--FROM vPOI_I_COMMON_ALL_GRS A, PTC_POI_CLASS B, PTC_CLASS C, POI_MAIN_ETC..[22y_2150_INDEX_220401] D
--WHERE A.POI_ID = B.POI_ID
--AND B.CLASS_CODE = C.CLASS_CODE
--AND LEFT(A.TILE_ID,4) = D.MAP_ID
--AND D.관할업체 = '티아이랩'
--AND A.INSERT_DATE < '2025-11-17 00:00:00.000'
--AND A.UPDATE_DATE < '2025-11-17 00:00:00.000' 
--GROUP BY C.CA_NAME
--ORDER BY CA_NAME

/*
  25년 12월까지의 POI 현황
*/
--SELECT COUNT(*) AS '티아이랩_전체_CORE_POI'
--FROM vPOI_I_COMMON_ALL_GRS A, PTC_POI_CLASS B, PTC_CLASS C, POI_MAIN_ETC..[22y_2150_INDEX_220401] D
--WHERE A.POI_ID = B.POI_ID
--AND B.CLASS_CODE = C.CLASS_CODE
--AND LEFT(A.TILE_ID,4) = D.MAP_ID
--AND D.관할업체 = '티아이랩'
--AND A.INSERT_DATE < '2025-12-15 00:00:00.000'
--AND A.UPDATE_DATE < '2025-12-15 00:00:00.000' 
--GROUP BY C.CA_NAME
--ORDER BY CA_NAME
